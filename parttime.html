<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id = "gridContainer" onscroll="showWebGL">
        <ul id ="grid">
        </ul>
    </div>
    <script>
            // --grid-layout-gap: 10px;
            // --grid-column-count: 3;
            // --grid-item--min-width: 200px;
            // --gap-count: calc(var(--grid-column-count) - 1);
            // --total-gap-width: calc(var(--gap-count) * var(--grid-layout-gap));
            // --grid-item--max-width: calc((100% - var(--total-gap-width)) / var(--grid-column-count));

            // display: grid;
            // grid-template-columns: repeat(auto-fill, minmax(max(var(--grid-item--min-width), var(--grid-item--max-width)), 1fr));
            // grid-gap: var(--grid-layout-gap);
        var grid = document.getElementById('grid')
        var gridContainer = document.getElementById('gridContainer')
        grid.style.cssText = 'list-style-type: none; margin: 0; padding: 0;--grid-item--max-width: calc((100% - 20px) / 3);display: grid;grid-template-columns: repeat(auto-fill, minmax(max(300px, var(--grid-item--max-width)), 1fr));grid-gap: 10px;'
        gridContainer.style.setProperty('height', '800px');
        grid.style.setProperty('height', '2500px');
        gridContainer.style.setProperty('overflow-y', 'scroll');
        var url = {
        '예지상가 2층':'https://my.matterport.com/show/?m=wWoMthPXAin',
        '예지상가 1층':'https://my.matterport.com/show/?m=6SvDwjew5Dz',
        '충남식당':'https://my.matterport.com/show/?m=Fdkb7KAjoVc',
        '주차장길+등나무골목':'https://my.matterport.com/show/?m=6tXJ32A4sut',
        '을지공예':'https://my.matterport.com/show/?m=3Yewzo9ZFLo',
        '석산정':'https://my.matterport.com/show/?m=7oxmkgFjgJg',
        '대진정밀':'https://my.matterport.com/show/?m=jzMEvuk7wQR',
        '대한스프링':'https://my.matterport.com/show/?m=8y2iCSSPhLv',
        '대영절단':'https://my.matterport.com/show/?m=gccaX7yxMAo',
        '만물사':'https://my.matterport.com/show/?m=5pRaTsm5MLa',
        '우일집':'https://my.matterport.com/show/?m=yNztpNu3Thp',
        '태성볼트':'https://my.matterport.com/show/?m=JGZiyQanJGd',
        '대림정밀':'https://my.matterport.com/show/?m=Ttsf26qsueT',
        '세운기공사':'https://my.matterport.com/show/?m=vGSpNixXkUx',
        '우주정밀':'https://my.matterport.com/show/?m=uLh6anLkdU2',
        '대동정밀':'https://my.matterport.com/show/?m=7kYrQfwcdhF',
        '선우정공':'https://my.matterport.com/show/?m=P85fYScPbXn',
        '신광알곤':'https://my.matterport.com/show/?m=P85fYScPbXn',
        '태광정밀':'https://my.matterport.com/show/?m=nhdiQaUTJee',
        '한진정밀':'https://my.matterport.com/show/?m=3g4GkEc59ZU',
        '근대정밀':'https://my.matterport.com/show/?m=M3s7YVHDysy',
        '현대정공':'https://my.matterport.com/show/?m=CrG8cTWq9eH',
        '대일로구로':'https://my.matterport.com/show/?m=PcUKE6Qai6T',
        '오성기업':'https://my.matterport.com/show/?m=PwdWVY5E5Hh',
        '호진정밀':'https://my.matterport.com/show/?m=g5FGW6PCJ2n',
        '우신정밀':'https://my.matterport.com/show/?m=15LaUcwwFqq',
        '영광주물':'https://my.matterport.com/show/?m=wcPCnsXkN1i',
        '원오정밀':'https://my.matterport.com/show/?m=pYnbiFFsuxD',
        '진성정밀':'https://my.matterport.com/show/?m=czCnv5KMKcE',
        '삼미기계':'https://my.matterport.com/show/?m=n5gfd6eo42z',
        '조선옥':'https://my.matterport.com/show/?m=uw9RJRBTanS',
        }



        var urlList = Object.values(url);
        var keyList = Object.keys(url);

        function createWebGL() {

            for (let i = 0; i < urlList.length; i++) {
                var li = document.createElement('li');
                var p = document.createElement('p');
                var ifr = document.createElement('iframe');
                p.append(keyList[i]);
                li.append(p, ifr);
                li.style.cssText = 'text-align : center; color : white;'
                ifr.style.display = 'none';
                grid.appendChild(li);
            }
            
        }
        function curtain() {
            var ifrList = document.querySelectorAll('iframe');
            var liList = document.querySelectorAll('li');
            var gridConRec = gridContainer.getBoundingClientRect();
            for (let i = 0; i < liList.length; i++) {
                var liRec = liList[i].getBoundingClientRect();
                liList[i].style.transition = 'all 0s ease';
                if (liRec.top > gridConRec.bottom || liRec.bottom < gridConRec.top) {
                }
                 else {
                    ifrList[i].setAttribute('src',urlList[i]);
                    ifrList[i].style.display = '';
                    console.log('hello')
                }
            }
        };
        
        function showWebGL() {
            createWebGL();
            curtain();
        }
        grid.addEventListener('load', showWebGL());
        gridContainer.addEventListener('scroll', function () {curtain()});


        var liList = document.querySelectorAll('li');
        var ifrList = document.querySelectorAll('iframe');
        var arr=new Array();
        liList.forEach(function(item,i){
        arr[i]=item.getBoundingClientRect().top
        });
        console.log(arr);
                var iarr=new Array();
        liList.forEach(function(item,i){
        iarr[i]=i
        });
        console.log(iarr);
        const resultArr = arr.reduce((item, index) =>{
            if (typeof item.last === 'undefined' || item.last !== index) {
                item.last = index;
                item.arr.push([]);
            }
            item.arr[item.arr.length - 1].push(index);
            return item;
        }, {arr: []}).arr;


        function multiplyAll() {
        // Only change code below this line
            let e = 0;
        for (let i = 0; i < resultArr.length; i++) {
            for (let j = 0; j < resultArr[i].length; j++) {
                
            resultArr[i][j] = iarr[e]
                if(e < iarr.length){
                    e = e+1;
                }
                
            }
        }
            console.log(resultArr)
        }
        function classDivider(){
                let e = 0;
            for (let i = 0; i < resultArr.length; i++) {
                for (let j = 0; j < resultArr[i].length; j++) {
                    resultArr[i][j] = '"'+i+'"'
                    ifrList[e].classList.add(resultArr[i][j])
                    if(e < ifrList.length){
                         e = e+1;
                    }
                }
            }
        }
        classDivider();
        console.log(ifrList);
        
    </script>
</body>
</html>